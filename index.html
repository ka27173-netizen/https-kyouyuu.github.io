<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>情報共有特設サイト</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* カスタムスタイル */
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
            background-color: #f8fafc; /* Tailwindのgray-50 */
        }
        /* 横スクロールコンテナのスクロールバーを非表示にし、スナップを効かせる */
        .calendar-scroll-container {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
            scroll-snap-type: x mandatory;
        }
        .calendar-scroll-container::-webkit-scrollbar {
            display: none; /* Chrome, Safari, and Opera */
        }
        .calendar-month {
            scroll-snap-align: center;
        }
        /* イベント用の基本スタイル */
        .event {
            font-size: 0.75rem; /* 12px */
            padding: 2px 4px;
            margin-top: 4px;
            border-radius: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            border: 1px solid transparent;
            cursor: pointer;
        }
        /* 通常の予定 */
        .event-normal {
            background-color: #e0e7ff; /* indigo-100 */
            color: #3730a3; /* indigo-800 */
            border-color: #c7d2fe; /* indigo-200 */
        }
        /* 土曜日の予定 */
        .event-saturday {
            background-color: #cffafe; /* cyan-100 */
            color: #0e7490; /* cyan-700 */
            border-color: #a5f3fc; /* cyan-200 */
        }
        /* 優先度高の予定（オレンジ） */
        .event-high-priority {
            background-color: #fffbeb; /* amber-50 */
            color: #b45309; /* amber-700 */
            border-color: #fde68a; /* amber-200 */
        }
        /* 大事な予定（黒） */
        .event-important {
            background-color: #1f2937; /* gray-800 */
            color: #f9fafb; /* gray-50 */
        }
        /* Webコンテストの予定（緑） */
        .event-contest {
            background-color: #dcfce7; /* green-100 */
            color: #166534; /* green-800 */
            border-color: #bbf7d0; /* green-200 */
        }
        /* 過去の日のイベント */
        .past-day .event-normal, .past-day .event-saturday, .past-day .event-high-priority, .past-day .event-contest {
            background-color: #e5e7eb; /* gray-200 */
            color: #6b7280; /* gray-500 */
            border-color: #d1d5db; /* gray-300 */
        }
         .past-day .event-important {
            background-color: #6b7280; /* gray-500 */
            color: #d1d5db; /* gray-300 */
        }
        /* Modal styles */
        #event-modal, #event-modal-backdrop {
            transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out;
        }
        #event-modal.hidden, #event-modal-backdrop.hidden {
            opacity: 0;
            visibility: hidden;
        }
        /* カウントダウンタイマーのスタイル（シンプル版） */
        .flip-card {
            /* background-color と color を削除し、JSで動的に制御 */
            padding: 0.75rem 1rem;
            font-size: 2.5rem; /* 40px */
            line-height: 1;
            font-weight: bold;
            border-radius: 0.5rem; /* 8px */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: background-color 0.3s, color 0.3s, border-color 0.3s; /* アニメーション */
            border: 1px solid transparent; /* 枠線用のスペース確保 */
        }
        @media (min-width: 640px) {
            .flip-card {
                padding: 1rem 1.5rem;
                font-size: 3.75rem; /* 60px */
            }
        }
    </style>
</head>
<body class="text-gray-800 pt-16">

    <header class="bg-white shadow-md fixed top-0 left-0 right-0 z-10">
        <div class="container mx-auto px-4 md:px-8 max-w-7xl">
            <nav class="flex justify-between items-center h-16">
                <div class="text-xl font-bold text-indigo-600">
                    情報共有ページ
                </div>
                <div class="space-x-4 md:space-x-8">
                    <a href="#notifications" class="text-gray-600 hover:text-indigo-600 font-medium transition-colors">連絡事項</a>
                    <a href="#calendar" class="text-gray-600 hover:text-indigo-600 font-medium transition-colors">カレンダー</a>
                    <a href="#links" class="text-gray-600 hover:text-indigo-600 font-medium transition-colors">リンク</a>
                </div>
            </nav>
        </div>
    </header>

    <main class="container mx-auto p-4 md:p-8 max-w-7xl">
    
        <!-- 0. カウントダウンタイマー (メイン：黒・緑) -->
        <section id="countdown-main" class="mb-8 md:mb-12 pt-4">
            <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200 text-center">
                <h3 id="countdown-title-main" class="text-xl font-semibold text-gray-700 mb-4">次の締切・重要予定</h3>
                <div class="flex justify-center items-baseline space-x-2" id="countdown-timer-container-main">
                    <div id="countdown-timer-main" class="flex justify-center items-center space-x-1 sm:space-x-2">
                        <!-- JavaScriptによって数字がここに挿入されます -->
                    </div>
                    <span class="text-3xl sm:text-4xl font-bold text-gray-800">日</span>
                </div>
                <p id="countdown-event-name-main" class="mt-3 text-lg sm:text-xl text-indigo-600 font-bold"></p>
            </div>
        </section>

        <!-- 0.5. カウントダウンタイマー (優先：黄) -->
        <section id="countdown-priority" class="mb-8 md:mb-12 pt-4">
            <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200 text-center">
                <h3 id="countdown-title-priority" class="text-xl font-semibold text-gray-700 mb-4">次の優先予定</h3>
                <div class="flex justify-center items-baseline space-x-2" id="countdown-timer-container-priority">
                    <div id="countdown-timer-priority" class="flex justify-center items-center space-x-1 sm:space-x-2">
                        <!-- JavaScriptによって数字がここに挿入されます -->
                    </div>
                    <span class="text-3xl sm:text-4xl font-bold text-gray-800">日</span>
                </div>
                <p id="countdown-event-name-priority" class="mt-3 text-lg sm:text-xl text-indigo-600 font-bold"></p>
            </div>
        </section>

        <!-- 1. 連絡したいこと -->
        <section id="notifications" class="mb-8 md:mb-12 pt-4">
            <h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-4 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-3 text-indigo-600"><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"></path><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"></path></svg>
                連絡事項
            </h2>
            <div class="space-y-4">
                <div class="bg-white p-4 rounded-lg shadow-sm border-l-4 border-yellow-400">
                    <p class="font-semibold text-gray-800">
                        【重要】<a href="https://jnk4.org/JAPIAS-DBx/WebContest/myPage/?p=x17xi80375jt" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline">今年度のスケジュール</a>
                        <span class="text-sm text-gray-600 font-normal ml-4">このページのパスワード 280075Wgq2</span>
                    </p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                    <p class="font-semibold text-gray-800">【重要】HTML・CSSのコードのスペースは基本半角にしてください</p>
                    <p class="text-sm text-gray-600 mt-1">半角にしなかった場合エラーが起きる可能性があります(こういう文章の中に全角スペースはいいですよ)</p>
                    <p class="text-sm text-gray-600 mt-1">VSコードにこれを入れると便利ですよ <a href="https://qiita.com/Junpei_Takagi/items/3983cc735e71ea3917fd" class="text-indigo-600 hover:underline">https://qiita.com/Junpei_Takagi/items/3983cc735e71ea3917fd</a></p>
                    <p class="text-sm text-gray-600 mt-1">これを入れるとエラーが起きそうな全角スペースの場所を赤色にしてくれます(さっきもいったけど文章の中の全角スペースはいいよ)</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                    <p class="font-semibold text-gray-800">出典用のページを作成しました</p>
                    <p class="text-sm text-gray-600 mt-1">syuten.htmlを出典用HPにします</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                    <p class="font-semibold text-gray-800">スライド・スライド原稿</p>
                    <p class="text-sm text-gray-600 mt-1">ぱぱっとと終わらせてHP改善したいです</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                    <p class="font-semibold text-gray-800">ファイル構成を変更します</p>
                    <p class="text-sm text-gray-600 mt-1">トップページをindex.htmlホームボタンを押して飛ぶトップページをhome.htmlにする予定です</p>
                </div>
            </div>
        </section>

        <!-- 2. カレンダー機能 -->
        <section id="calendar" class="mb-8 md:mb-12 pt-4">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl md:text-3xl font-bold text-gray-900 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-3 text-indigo-600"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"></rect><line x1="16" x2="16" y1="2" y2="6"></line><line x1="8" x2="8" y1="2" y2="6"></line><line x1="3" x2="21" y1="10" y2="10"></line></svg>
                    カレンダー
                </h2>
                <div class="flex space-x-2">
                    <button id="prev-month" class="bg-indigo-600 text-white p-2 rounded-full shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-transform duration-150 active:scale-95">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"></path></svg>
                    </button>
                    <button id="next-month" class="bg-indigo-600 text-white p-2 rounded-full shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-transform duration-150 active:scale-95">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"></path></svg>
                    </button>
                </div>
            </div>
            
            <div id="calendar-scroll-container" class="calendar-scroll-container flex overflow-x-auto bg-white rounded-lg shadow-lg p-4 border border-gray-200">
                <!-- カレンダーがここに動的に生成されます -->
            </div>
        </section>

        <!-- 3. リンク一覧 -->
        <section id="links" class="pt-4">
            <h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-4 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-3 text-indigo-600"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.72"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.72-1.72"></path></svg>
                リンク一覧
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- 僕らが作ってるHP -->
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 md:col-span-2 lg:col-span-3">
                    <h3 class="text-xl font-semibold text-indigo-700 mb-3">僕らが作ってるHP</h3>
                    <ul class="space-y-2">
                        <li><a href="file:///media/fuse/drivefs-ab8b5b3ed99213de0T5b56a773760e8/team_drives/%E4%B8%AD%E5%AD%A6%E6%8A%80%E8%A1%93%E7%A7%91%EF%BC%8BWeb%E3%82%B3%E3%83%B3%E3%83%86%E3%82%B9%E3%83%88/2025%E4%B8%AD2Web%E3%82%B3%E3%83%B3%E3%83%86%E3%82%B9%E3%83%88/25B07%E5%AE%88%E5%B1%8B%E5%B4%87%E7%A7%80/Actualperformance/top.html" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline flex items-center">トップページへ <span class="ml-1 text-xs">↗</span></a></li>
                    </ul>
                </div>
                <!-- ドキュメント -->
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h3 class="text-xl font-semibold text-blue-700 mb-3">ドキュメント</h3>
                    <ul class="space-y-2">
                        <li><a href="https://docs.google.com/document/d/1H4mZVyTgOn_uucbsnx7yhpFL7TuT84JS1XSJW9t7OLg/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline flex items-center">HPに書く内容<span class="ml-1 text-xs">↗</span></a></li>
                        <li><a href="https://docs.google.com/document/d/1-p__bNjTk10BAiD1SSX4QLftd-tIYb_sD8ZLX6EtorY/edit?tab=t.0" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline flex items-center">B07発表原稿シート<span class="ml-1 text-xs">↗</span></a></li>
                        <li><a href="https://docs.google.com/document/d/1NS0wGDr8qWzUCs2MoJXeUxpnOkt1ux-q8kaGvXJK6Jc/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline flex items-center">スライドの原稿　大まかな内容<span class="ml-1 text-xs">↗</span></a></li>
                    </ul>
                </div>
                <!-- スライド -->
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h3 class="text-xl font-semibold text-orange-600 mb-3">スライド</h3>
                    <ul class="space-y-2">
                        <!-- 既存のB07発表スライド -->
                        <li><a href="https://docs.google.com/presentation/d/1uk0yrDRlRE3riRvJ-Y7oLR537nh-eqgjAsGSlfsjHuE/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline flex items-center">B07発表スライド <span class="ml-1 text-xs">↗</span></a></li>
                        <!-- 追加されたエコチルスライド -->
                        <li><a href="https://docs.google.com/presentation/d/1SHobnO43MlsjMwDsag2PK9QeMfPYaNwzyRbAsP-T4MQ/edit" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline flex items-center">エコチルスライド <span class="ml-1 text-xs">↗</span></a></li>
                    </ul>
                </div>
                <!-- スプレッドシート -->
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h3 class="text-xl font-semibold text-green-700 mb-3">スプレッドシート</h3>
                    <ul class="space-y-2">
                        <li><a href="https://docs.google.com/spreadsheets/d/1n4ZSHqn7fsye8tMvatf0orqJIvPSCgzB4tFCH4KZZLE/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline flex items-center">HPの改善点(回答)<span class="ml-1 text-xs">↗</span></a></li>
                        <li><a href="https://docs.google.com/spreadsheets/d/1L-cnJNl7g_j2r2yUi89ereJFS1VkGi0UHnSze8cYwcA/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline flex items-center">外国人に向けたアンケート(回答)<span class="ml-1 text-xs">↗</span></a></li>
                    </ul>
                </div>
                <!-- フォーム -->
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h3 class="text-xl font-semibold text-purple-700 mb-3">フォーム</h3>
                    <ul class="space-y-2">
                        <li><a href="https://docs.google.com/forms/d/e/1FAIpQLSe4KbW5mQQ-IkXeLNCWCMlkHDpdLkCkay08A6X1EvFbjNoEYg/viewform?usp=header" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline flex items-center">HPの改善点<span class="ml-1 text-xs">↗</span></a></li>
                        <li><a href="https://docs.google.com/forms/d/e/1FAIpQLSedhvF_EvlkiKNTw5-Rfg9Jsf5b7KGas9hEtRhIVZygbkS40A/viewform?usp=header" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline flex items-center">外国人に向けたアンケート<span class="ml-1 text-xs">↗</span></a></li>
                    </ul>
                </div>
                <!-- ドライブ -->
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h3 class="text-xl font-semibold text-red-700 mb-3">ドライブ</h3>
                    <ul class="space-y-2">
                        <li><a href="https://drive.google.com/drive/folders/1V6d5EiszW-dLcywv0UvRTMjVaCGfoFqo" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline flex items-center">共有ドライブ(B07) <span class="ml-1 text-xs">↗</span></a></li>
                    </ul>
                </div>
                <!-- よく使いそうなサイト -->
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h3 class="text-xl font-semibold text-teal-700 mb-3">よく使いそうなサイト</h3>
                    <ul class="space-y-2">
                        <li><a href="https://www.canva.com/" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline flex items-center">Canva (デザインツール) <span class="ml-1 text-xs">↗</span></a></li>
                        <li><a href="https://mail.google.com/chat/u/0/#chat/space/AAQAquQBKsk" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline flex items-center">チャットツール <span class="ml-1 text-xs">↗</span></a></li>
                        <li><a href="https://contest.japias.jp/tqj27/270096A/index.html" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline flex items-center">昆虫食が世界を救う <span class="ml-1 text-xs">↗</span></a></li>
                    </ul>
                </div>
                <!-- その他 -->
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h3 class="text-xl font-semibold text-gray-600 mb-3">その他</h3>
                    <ul class="space-y-2">
                         <li><a href="https://jnk4.org/JAPIAS-DBx/WebContest/myPage/?p=x17xi80375jt" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline flex items-center">今年度のスケジュール<span class="ml-1 text-xs">↗</span></a></li>
                         <li><a href="https://webcon.japias.jp/rule.html" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline flex items-center">webコンのルール<span class="ml-1 text-xs">↗</span></a></li>
                    </ul>
                </div>
            </div>
        </section>

    </main>
    
    <!-- Modal Backdrop -->
    <div id="event-modal-backdrop" class="fixed inset-0 bg-black bg-opacity-50 hidden z-40"></div>

    <!-- Event Modal -->
    <div id="event-modal" class="hidden fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-xl w-11/12 max-w-md p-6 z-50">
        <h3 id="modal-title" class="text-2xl font-bold text-gray-900 mb-2">Event Title</h3>
        <p id="modal-date" class="text-sm text-gray-500 mb-4">Event Date</p>
        <div class="mb-4">
            <h4 class="font-semibold text-gray-700 mb-2">備考欄</h4>
            <p id="modal-remarks" class="text-gray-600 bg-gray-100 p-3 rounded-md min-h-[80px]">ここに備考が表示されます。</p>
        </div>
        <button id="modal-close-btn" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        </button>
    </div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    // --- イベントと祝日のデータ ---
    const holidays = [
        { year: 2025, month: 10, day: 3, name: '文化の日' },
        { year: 2025, month: 10, day: 24, name: '振替休日' },
        { year: 2026, month: 0, day: 1, name: '元日' },
        { year: 2026, month: 0, day: 12, name: '成人の日' },
        { year: 2026, month: 1, day: 11, name: '建国記念の日' },
        { year: 2026, month: 1, day: 23, name: '天皇誕生日' },
        { year: 2026, month: 2, day: 20, name: '春分の日' },
    ];
    const events = [
        { year: 2025, month: 9, day: 13, title: 'Web会議(4時頃〜)', type: 'high-priority', remarks: '参加必須です。会議用のリンクは直前に共有します。' },
        { year: 2025, month: 9, day: 25, title: '運動会', type: 'high-priority', remarks: '運動会' },
        { year: 2025, month: 10, day: 2, title: 'エコチル調査発表', type: 'important', remarks: '頑張りましょう。時間などは後日共有します' },
        { year: 2025, month: 10, day: 6, title: '芸術鑑賞会', type: 'high-priority', remarks: '場所：有明四季劇場　現地集合・解散。' },
        { year: 2025, month: 10, day: 8, title: '探求Day', type: 'important', remarks: 'モリヤは公欠' },
        { year: 2025, month: 11, day: 2, title: '後期中間考査', type: 'high-priority', remarks: '試験頑張ってね。' },
        { year: 2025, month: 11, day: 3, title: '後期中間考査', type: 'high-priority', remarks: '試験頑張ってね。' },
        { year: 2025, month: 11, day: 4, title: '後期中間考査', type: 'high-priority', remarks: '試験頑張ってね。' },
        { year: 2025, month: 11, day: 12, title: '合唱祭', type: 'high-priority', remarks: '合唱祭頑張ってね' },
        { year: 2025, month: 9, day: 22, title: '提出申請の受付締切', type: 'contest', remarks: '厳守' },
        { year: 2025, month: 9, day: 30, title: 'ストリーミングサーバーオープン', type: 'contest', remarks: '11月20日まで' },
        { year: 2025, month: 9, day: 30, title: '作品・サイトプロフィール提出オープン', type: 'contest', remarks: '11月20日まで' },
        { year: 2025, month: 9, day: 31, title: '希望ドメイン名の登録オープン', type: 'contest', remarks: '11月13日まで' },
        { year: 2025, month: 10, day: 13, title: 'ドメイン名の登録締切', type: 'contest', remarks: '厳守' },
        { year: 2025, month: 10, day: 20, title: 'ストリーミングサーバーの利用クローズ', type: 'contest', remarks: '' },
        { year: 2025, month: 10, day: 20, title: '作品の提出締切', type: 'contest', remarks: '厳守' },
        { year: 2025, month: 11, day: 10, title: 'トップ50およびセミファイナリスト発表', type: 'contest', remarks: '予定' },
        { year: 2025, month: 11, day: 27, title: '改良した作品・サイトプロフィール再提出の締切', type: 'contest', remarks: '厳守' },
        { year: 2025, month: 11, day: 27, title: 'ベストドメインネーミング賞応募締切', type: 'contest', remarks: 'レポート提出' },
        { year: 2026, month: 0, day: 24, title: 'ベストクリエイティブ賞 作品提出締切', type: 'contest', remarks: 'CM動画部門' },
        { year: 2026, month: 0, day: 30, title: 'ベストクリエイティブ賞 の改良受付', type: 'contest', remarks: 'CM動画部門(未定)' },
        { year: 2026, month: 1, day: 5, title: 'ベストクリエイティブ賞 の作品提出締切(改良版)', type: 'contest', remarks: 'CM動画部門(未定)' },
        { year: 2026, month: 0, day: 13, title: 'ファイナリスト発表', type: 'contest', remarks: '' },
        { year: 2026, month: 1, day: 18, title: 'プレゼン資料提出締切', type: 'contest', remarks: '厳守' },
        { year: 2026, month: 1, day: 21, title: 'ファイナリストプレゼンテーション', type: 'contest', remarks: 'プレゼン審査および授賞式' },
        { year: 2026, month: 1, day: 21, title: '最終結果発表', type: 'contest', remarks: '授賞式' },
    ];
    
    // --- モーダル機能 ---
    const modal = document.getElementById('event-modal');
    const backdrop = document.getElementById('event-modal-backdrop');
    const modalTitle = document.getElementById('modal-title');
    const modalDate = document.getElementById('modal-date');
    const modalRemarks = document.getElementById('modal-remarks');
    const closeModalBtn = document.getElementById('modal-close-btn');

    function openEventModal(eventData) {
        modalTitle.textContent = eventData.title;
        modalDate.textContent = `${eventData.year}年${eventData.month + 1}月${eventData.day}日`;
        modalRemarks.textContent = eventData.remarks || '特にありません。';
        modal.classList.remove('hidden');
        backdrop.classList.remove('hidden');
    }

    function closeModal() {
        modal.classList.add('hidden');
        backdrop.classList.add('hidden');
    }

    closeModalBtn.addEventListener('click', closeModal);
    backdrop.addEventListener('click', closeModal);

    // --- カウントダウン機能 ---
    function setupCountdowns() { // 関数名を複数形に変更
        // --- メインタイマー（黒＋緑）の要素 ---
        const countdownTimerMainEl = document.getElementById('countdown-timer-main');
        const countdownEventNameMainEl = document.getElementById('countdown-event-name-main');
        const countdownSectionMain = document.getElementById('countdown-main');

        // --- 優先タイマー（黄）の要素 ---
        const countdownTimerPriorityEl = document.getElementById('countdown-timer-priority');
        const countdownEventNamePriorityEl = document.getElementById('countdown-event-name-priority');
        const countdownSectionPriority = document.getElementById('countdown-priority');

        const today = new Date(); // 常に実際の日付を取得
        // 日付の時刻を0時0分0秒にリセット
        today.setHours(0, 0, 0, 0);

        // --- 1. メインタイマー（黒＋緑）のロジック ---
        const mainEvents = events.filter(e => 
            e.type === 'important' || 
            e.type === 'contest'
        );
        const upcomingMainEvents = mainEvents
            .map(e => ({ ...e, date: new Date(e.year, e.month, e.day) }))
            .filter(e => e.date >= today)
            .sort((a, b) => a.date - b.date);

        if (upcomingMainEvents.length > 0) {
            const nextEvent = upcomingMainEvents[0];
            const targetDate = nextEvent.date;
            const diffTime = targetDate - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

            let dayColorClass = 'bg-gray-800 text-gray-50'; // デフォルト (6日以上前)
            if (diffDays <= 5 && diffDays > 0) {
                dayColorClass = 'bg-red-100 text-red-700 border-red-300';
            } else if (diffDays === 0) {
                dayColorClass = 'bg-red-600 text-white border-red-700';
            }

            countdownEventNameMainEl.textContent = `「${nextEvent.title}」まで`;
            countdownEventNameMainEl.style.cursor = 'pointer';
            countdownEventNameMainEl.classList.add('hover:underline');
            
            countdownEventNameMainEl.addEventListener('click', () => {
                openEventModal({
                    title: nextEvent.title,
                    year: nextEvent.date.getFullYear(),
                    month: nextEvent.date.getMonth(),
                    day: nextEvent.date.getDate(),
                    remarks: nextEvent.remarks
                });
            });

            const daysString = diffDays.toString().padStart(2, '0');
            countdownTimerMainEl.innerHTML = `
                <span class="flip-card ${dayColorClass}">${daysString[0]}</span>
                <span class="flip-card ${dayColorClass}">${daysString[1]}</span>
            `;
        } else {
            countdownSectionMain.innerHTML = '<p class="text-lg text-gray-600 text-center">現在、直近の締切・重要予定はありません。</p>';
        }

        // --- 2. 優先タイマー（黄）のロジック ---
        const priorityEvents = events.filter(e => e.type === 'high-priority');
        const upcomingPriorityEvents = priorityEvents
            .map(e => ({ ...e, date: new Date(e.year, e.month, e.day) }))
            .filter(e => e.date >= today)
            .sort((a, b) => a.date - b.date);
        
        if (upcomingPriorityEvents.length > 0) {
            const nextEvent = upcomingPriorityEvents[0];
            const targetDate = nextEvent.date;
            const diffTime = targetDate - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

            let dayColorClass = 'bg-gray-800 text-gray-50'; // デフォルト (6日以上前)
            if (diffDays <= 5 && diffDays > 0) {
                dayColorClass = 'bg-red-100 text-red-700 border-red-300';
            } else if (diffDays === 0) {
                dayColorClass = 'bg-red-600 text-white border-red-700';
            }

            countdownEventNamePriorityEl.textContent = `「${nextEvent.title}」まで`;
            countdownEventNamePriorityEl.style.cursor = 'pointer';
            countdownEventNamePriorityEl.classList.add('hover:underline');
            
            countdownEventNamePriorityEl.addEventListener('click', () => {
                openEventModal({
                    title: nextEvent.title,
                    year: nextEvent.date.getFullYear(),
                    month: nextEvent.date.getMonth(),
                    day: nextEvent.date.getDate(),
                    remarks: nextEvent.remarks
                });
            });

            const daysString = diffDays.toString().padStart(2, '0');
            countdownTimerPriorityEl.innerHTML = `
                <span class="flip-card ${dayColorClass}">${daysString[0]}</span>
                <span class="flip-card ${dayColorClass}">${daysString[1]}</span>
            `;
        } else {
            countdownSectionPriority.innerHTML = '<p class="text-lg text-gray-600 text-center">現在、直近の優先予定はありません。</p>';
        }
    }

    // --- カレンダー機能 ---
    const calendarContainer = document.getElementById('calendar-scroll-container');
    const prevButton = document.getElementById('prev-month');
    const nextButton = document.getElementById('next-month');
    const startDate = new Date(2025, 9, 1);
    const endDate = new Date(2026, 2, 1);

    function createMonthCalendar(year, month) {
        const monthDiv = document.createElement('div');
        monthDiv.className = 'calendar-month flex-shrink-0 w-full p-2';
        const monthName = new Date(year, month).toLocaleString('ja-JP', { year: 'numeric', month: 'long' });
        let html = `<div class="text-center mb-4"><h3 class="text-xl font-semibold">${monthName}</h3></div>`;
        html += '<table class="w-full text-sm text-center border-collapse table-fixed">';
        html += '<thead><tr class="text-gray-600">';
        const weekdays = ['日', '月', '火', '水', '木', '金', '土'];
        weekdays.forEach((day, i) => {
            let colorClass = '';
            if (i === 0) colorClass = 'text-red-500';
            if (i === 6) colorClass = 'text-blue-500';
            html += `<th class="p-2 w-1/7 border-b ${colorClass}">${day}</th>`;
        });
        html += '</tr></thead><tbody>';
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        const today = new Date(); // 常に実際の日付を取得
        // 日付の時刻を0時0分0秒にリセット
        today.setHours(0, 0, 0, 0);
        let date = 1;
        for (let i = 0; i < 6; i++) {
            html += '<tr>';
            for (let j = 0; j < 7; j++) {
                if (i === 0 && j < firstDay || date > daysInMonth) {
                    html += '<td class="border p-1"></td>';
                } else {
                    const currentDate = new Date(year, month, date);
                    currentDate.setHours(0, 0, 0, 0);
                    let tdClass = '', dateDivClass = '', dateTextClass = '', holidayName = '';
                    const isPast = currentDate < today;
                    const isToday = currentDate.getTime() === today.getTime();
                    const dayOfWeek = currentDate.getDay();
                    const holiday = holidays.find(h => h.year === year && h.month === month && h.day === date);
                    const isSportsDay = year === 2025 && month === 9 && date === 13;
                    const isHoliday = holiday || isSportsDay;

                    if (holiday) {
                        const holidayTextColor = isPast ? 'text-gray-400' : 'text-red-700';
                        holidayName = `<div class="text-xs ${holidayTextColor} truncate">${holiday.name}</div>`;
                    } else if (isSportsDay) {
                        const holidayTextColor = isPast ? 'text-gray-400' : 'text-red-700';
                        holidayName = `<div class="text-xs ${holidayTextColor} truncate">スポーツの日</div>`;
                    }
                    
                    if (isHoliday) tdClass = 'bg-red-100';
                    else if (dayOfWeek === 0) tdClass = 'bg-red-100';
                    else if (dayOfWeek === 6) tdClass = 'bg-blue-100';

                    if (isPast) {
                        tdClass += ' past-day';
                        dateTextClass = 'text-gray-400';
                    } else {
                        if (isHoliday) dateTextClass = 'text-red-700';
                        else if (dayOfWeek === 0) dateTextClass = 'text-red-500';
                        else if (dayOfWeek === 6) dateTextClass = 'text-blue-500';
                        else dateTextClass = 'text-gray-800';
                    }

                    if (isToday) {
                        dateDivClass = 'bg-indigo-600 rounded-full';
                        dateTextClass = 'text-white font-bold';
                    }
                    
                    const dayEvents = events.filter(e => e.year === year && e.month === month && e.day === date);
                    const isNotNov8th = !(year === 2025 && month === 10 && date === 8);
                    const isNotOct25th = !(year === 2025 && month === 9 && date === 25);
                    if (dayOfWeek === 6 && isNotNov8th && isNotOct25th) {
                        dayEvents.push({ title: 'Worldday', type: 'saturday', remarks: '定例のWorlddayです。' });
                    }
                    let eventHtml = dayEvents.map(e => {
                        let eventClass = '';
                        switch(e.type) {
                            case 'important': eventClass = 'event-important'; break;
                            case 'high-priority': eventClass = 'event-high-priority'; break;
                            case 'saturday': eventClass = 'event-saturday'; break;
                            case 'contest': eventClass = 'event-contest'; break;
                            default: eventClass = 'event-normal';
                        }
                        const remarks = e.remarks || '';
                        return `<div class="event ${eventClass}" 
                                     title="${e.title}" 
                                     data-title="${e.title}"
                                     data-year="${year}"
                                     data-month="${month}"
                                     data-day="${date}"
                                     data-remarks="${remarks}"
                                     >${e.title}</div>`;
                    }).join('');
                    html += `<td class="border p-1 h-24 align-top ${tdClass.trim()}">
                                <div class="w-7 h-7 mx-auto flex items-center justify-center ${dateDivClass}">
                                    <span class="font-medium ${dateTextClass}">${date}</span>
                                </div>
                                ${holidayName}
                                ${eventHtml}
                             </td>`;
                    date++;
                }
            }
            html += '</tr>';
            if (date > daysInMonth) break;
        }
        html += '</tbody></table>';
        monthDiv.innerHTML = html;
        return monthDiv;
    }

    let calDate = new Date(startDate);
    while (calDate <= endDate) {
        const monthCalendar = createMonthCalendar(calDate.getFullYear(), calDate.getMonth());
        calendarContainer.appendChild(monthCalendar);
        calDate.setMonth(calDate.getMonth() + 1);
    }
    const scrollMonth = () => calendarContainer.querySelector('.calendar-month').offsetWidth;
    nextButton.addEventListener('click', () => calendarContainer.scrollBy({ left: scrollMonth(), behavior: 'smooth' }));
    prevButton.addEventListener('click', () => calendarContainer.scrollBy({ left: -scrollMonth(), behavior: 'smooth' }));

    calendarContainer.addEventListener('click', function(e) {
        const eventEl = e.target.closest('.event');
        if (eventEl) {
            openEventModal({
                title: eventEl.dataset.title,
                year: parseInt(eventEl.dataset.year),
                month: parseInt(eventEl.dataset.month),
                day: parseInt(eventEl.dataset.day),
                remarks: eventEl.dataset.remarks
            });
        }
    });

    // --- ページの初期化処理 ---
    setupCountdowns(); // 呼び出しを複数形に変更
});
</script>
</body>
</html>

